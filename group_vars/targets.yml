---
# =============================================================================
# Server Helper v2.0 â€” Target Node Variables
# =============================================================================
# Variables specific to target (non-control) nodes.

# -----------------------------------------------------------------------------
# Watchtower (Auto-updates)
# -----------------------------------------------------------------------------
target_watchtower:
  schedule: "0 0 4 * * *"  # 4:00 AM daily
  cleanup: true
  include_stopped: false
  include_restarting: false
  notifications: false

# -----------------------------------------------------------------------------
# Netdata Child Mode
# -----------------------------------------------------------------------------
target_netdata:
  version: "latest"
  port: 19999
  claim_enabled: false
  alarms:
    cpu_warning: 85
    cpu_critical: 95
    ram_warning: 85
    ram_critical: 95
    disk_warning: 80
    disk_critical: 90

# -----------------------------------------------------------------------------
# Promtail (Log Shipping)
# -----------------------------------------------------------------------------
target_promtail:
  version: "2.9.4"
  loki_url: "http://{{ target_control_ip }}:3100/loki/api/v1/push"

# Promtail Loki URL (used in templates)
promtail_loki_url: "{{ target_promtail.loki_url }}"

# -----------------------------------------------------------------------------
# Docker Socket Proxy
# -----------------------------------------------------------------------------
target_docker_socket_proxy:
  port: 2375
  version: "latest"

# -----------------------------------------------------------------------------
# Dockge (Stack Manager)
# -----------------------------------------------------------------------------
target_dockge:
  port: 5001
  version: "latest"

# -----------------------------------------------------------------------------
# Restic (Backups)
# -----------------------------------------------------------------------------
target_restic:
  schedule: "OnCalendar=*-*-* 02:00:00"  # 2:00 AM daily
  check_schedule: "OnCalendar=Sun *-*-* 03:00:00"  # Sunday 3:00 AM
  retention:
    keep_daily: 7
    keep_weekly: 4
    keep_monthly: 6
    keep_yearly: 1
  destinations:
    local:
      enabled: false
      path: "/backup/restic"
    s3:
      enabled: false
      endpoint: ""
      bucket: ""
      region: "us-east-1"
    nas:
      enabled: false
      path: ""
      mount_point: "/mnt/nas/backup"
  exclude_patterns:
    - "/proc"
    - "/sys"
    - "/dev"
    - "/run"
    - "/tmp"
    - "/var/cache"
    - "/var/tmp"
    - "*.log"
    - "*.tmp"
  backup_paths:
    - "/opt/stacks"
    - "/etc"
