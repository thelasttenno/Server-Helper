================================================================================
  SERVER HELPER v1.0.0 - SECURITY AUDIT REPORT
================================================================================

Server: {{ ansible_hostname }}
IP Address: {{ ansible_default_ipv4.address }}
Date: {{ ansible_date_time.iso8601 }}
OS: {{ ansible_distribution }} {{ ansible_distribution_version }}

================================================================================
  SSH SECURITY
================================================================================

{% if ssh_password_auth is defined %}
Password Authentication: {{ ssh_password_auth.stdout }}
{% endif %}
{% if ssh_root_login is defined %}
Root Login: {{ ssh_root_login.stdout }}
{% endif %}

Recommended Settings:
- PasswordAuthentication: no (use key-based auth)
- PermitRootLogin: no (use sudo with regular user)

================================================================================
  FIREWALL STATUS (UFW)
================================================================================

{% if ufw_status is defined and ufw_status.stdout_lines %}
{{ ufw_status.stdout }}
{% else %}
UFW status not available or disabled
{% endif %}

================================================================================
  FAIL2BAN STATUS
================================================================================

{% if fail2ban_status is defined and fail2ban_status.stdout_lines %}
{{ fail2ban_status.stdout }}
{% else %}
Fail2ban status not available or disabled
{% endif %}

================================================================================
  SECURITY UPDATES AVAILABLE
================================================================================

{% if security_updates is defined and security_updates.stdout_lines %}
{% for line in security_updates.stdout_lines %}
{{ line }}
{% endfor %}
{% else %}
No security updates checked or available
{% endif %}

================================================================================
  LYNIS AUDIT RESULTS
================================================================================

{% if lynis_score is defined %}
Lynis Security Score: {{ lynis_score }}/100
{% endif %}

Full Lynis report: /var/log/lynis-report.dat

To view detailed Lynis results:
  cat /var/log/lynis-report.dat
  lynis show details <test-id>

================================================================================
  RECOMMENDATIONS
================================================================================

1. Review and apply all security updates regularly
2. Ensure SSH is configured for key-based authentication only
3. Monitor fail2ban logs for intrusion attempts: journalctl -u fail2ban
4. Review UFW firewall rules and close unnecessary ports
5. Run Lynis regularly: sudo lynis audit system
6. Check Docker container vulnerabilities with Scanopy/Trivy
7. Review Netdata security alerts
8. Ensure backups are running and tested

================================================================================
  NEXT STEPS
================================================================================

- Review Lynis suggestions: lynis show suggestions
- Update system packages: apt update && apt upgrade
- Review authentication logs: grep -i "failed\|failure" /var/log/auth.log
- Check for listening services: netstat -tulpn
- Review user accounts: cat /etc/passwd
- Check sudo access: cat /etc/sudoers.d/*

================================================================================
Report generated by Server Helper v1.0.0
For more information: https://github.com/yourrepo/server-helper
================================================================================
