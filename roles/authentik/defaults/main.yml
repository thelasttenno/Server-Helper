---
# Authentik role defaults (Control Node)

# Master toggle (from control_authentik config)
authentik_enabled: "{{ control_authentik.enabled | default(true) }}"

# Skip actual Docker deployment (for molecule testing)
authentik_skip_deploy: false

# Container settings
authentik_image: "ghcr.io/goauthentik/server"
authentik_image_tag: "{{ control_authentik.version | default('2024.2') }}"

# Stack directory (Dockge compatible)
authentik_stack_dir: "/opt/stacks/authentik"

# Network ports (from control_authentik config)
authentik_http_port: "{{ control_authentik.port | default(9000) }}"
authentik_https_port: 9443

# Secret key (generate with: openssl rand -hex 32)
authentik_secret_key: "{{ vault_authentik_credentials.secret_key | default('') }}"

# PostgreSQL settings
authentik_postgres_enabled: true
authentik_postgres_image: "postgres:15-alpine"
authentik_postgres_db: "authentik"
authentik_postgres_user: "authentik"
authentik_postgres_password: "{{ vault_authentik_credentials.postgres_password | default('') }}"

# Redis settings
authentik_redis_enabled: true
authentik_redis_image: "redis:7-alpine"

# Initial admin account
authentik_bootstrap_email: "admin@{{ target_domain | default('example.local') }}"
authentik_bootstrap_password: "{{ vault_authentik_credentials.admin_password | default('') }}"
authentik_bootstrap_token: ""

# Email settings (optional)
authentik_email_enabled: false
authentik_email_host: ""
authentik_email_port: 587
authentik_email_username: ""
authentik_email_password: ""
authentik_email_use_tls: true
authentik_email_use_ssl: false
authentik_email_from: "authentik@{{ target_domain | default('example.local') }}"

# Error reporting
authentik_error_reporting_enabled: false

# Domain and branding
authentik_domain: "auth.{{ target_domain | default('example.local') }}"

# Outpost settings for embedded outpost
authentik_outpost_enabled: true

# Worker replicas
authentik_worker_replicas: 1

# Resource limits
authentik_server_memory_limit: "1g"
authentik_worker_memory_limit: "1g"
authentik_postgres_memory_limit: "512m"
authentik_redis_memory_limit: "128m"

# Geoip (optional, for location-based policies)
authentik_geoip_enabled: false
authentik_geoip_account_id: ""
authentik_geoip_license_key: ""
