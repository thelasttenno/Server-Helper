# {{ ansible_managed }}
# SSH Hardening â€” drop-in config at /etc/ssh/sshd_config.d/99-hardening.conf

PermitRootLogin {{ target_security.ssh_hardening.permit_root_login }}
PasswordAuthentication {{ target_security.ssh_hardening.password_authentication }}
MaxAuthTries {{ target_security.ssh_hardening.max_auth_tries }}
X11Forwarding {{ target_security.ssh_hardening.x11_forwarding }}
AllowTcpForwarding {{ target_security.ssh_hardening.allow_tcp_forwarding }}
ClientAliveInterval {{ target_security.ssh_hardening.client_alive_interval }}
ClientAliveCountMax {{ target_security.ssh_hardening.client_alive_count_max }}

# Disable empty passwords
PermitEmptyPasswords no

# Use strong key exchange algorithms
KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512

# Use strong ciphers
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com

# Use strong MACs
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com
