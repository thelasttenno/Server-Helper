# Fail2ban Configuration
# Managed by Ansible - Server Helper

[DEFAULT]
# Ban settings
bantime = {{ security_fail2ban_sshd_bantime }}
findtime = {{ security_fail2ban_sshd_findtime }}
maxretry = {{ security_fail2ban_sshd_maxretry }}

# Ignore localhost
ignoreip = 127.0.0.1/8 ::1

# Backend
backend = systemd

# Email settings (optional)
destemail = {{ target_notification_email | default('root@localhost') }}
sender = fail2ban@{{ ansible_hostname }}
mta = sendmail

# Actions
action = %(action_)s

[sshd]
enabled = true
port = {{ security_ssh_port }}
filter = sshd
logpath = /var/log/auth.log
maxretry = {{ security_fail2ban_sshd_maxretry }}
bantime = {{ security_fail2ban_sshd_bantime }}
