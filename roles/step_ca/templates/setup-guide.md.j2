# Step-CA Setup Guide

## Initial Setup
1. Start Step-CA: `cd {{ docker_stack_path }}/step-ca && docker compose up -d`
2. The CA initializes automatically on first start
3. Root CA cert location: `/home/step/certs/root_ca.crt` inside the container

## Get Root CA Certificate
```bash
docker cp step-ca:/home/step/certs/root_ca.crt /tmp/root_ca.crt
```

## Distribute to Targets
The root CA is automatically distributed via `site.yml` post-deployment.
Manual distribution:
```bash
ansible all -m copy -a "src=/tmp/root_ca.crt dest=/usr/local/share/ca-certificates/internal-ca.crt"
ansible all -m command -a "update-ca-certificates"
```

## Traefik Integration
Add to Traefik's certificate resolvers for internal certs:
```yaml
certificatesResolvers:
  internal:
    acme:
      caServer: https://step-ca.{{ target_domain }}:{{ control_step_ca.port }}/acme/acme/directory
```
