---
- name: Verify
  hosts: all
  gather_facts: true
  tasks:
    - name: Check stack directory exists
      ansible.builtin.stat:
        path: /opt/stacks/promtail
      register: stack_dir
      failed_when: not stack_dir.stat.exists

    - name: Check compose file exists
      ansible.builtin.stat:
        path: /opt/stacks/promtail/compose.yaml
      register: compose_file
      failed_when: not compose_file.stat.exists

    - name: Check promtail config exists
      ansible.builtin.stat:
        path: /opt/stacks/promtail/promtail-config.yml
      register: promtail_conf
      failed_when: not promtail_conf.stat.exists
