#!/bin/bash
# {{ ansible_managed }}
# Discord notification â€” JSON-safe
MSG="${1:-Alert}"
PAYLOAD=$(python3 -c "import json,sys; print(json.dumps({'content': sys.argv[1]}))" "$MSG" 2>/dev/null) || \
PAYLOAD="{\"content\": \"notification (encoding error)\"}"
curl -fsS -m 10 -H "Content-Type: application/json" \
  -d "$PAYLOAD" \
  "{{ notifications_discord.webhook }}" >/dev/null 2>&1 || true
