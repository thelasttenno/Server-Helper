---
dependency:
  name: galaxy
  options:
    requirements-file: requirements.yml
driver:
  name: docker
platforms:
  - name: instance
    image: geerlingguy/docker-ubuntu2404-ansible
    pre_build_image: true
    privileged: true
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:rw
    cgroupns_mode: host
    command: /lib/systemd/systemd
provisioner:
  name: ansible
  config_options:
    defaults:
      roles_path: ../../..
  playbooks:
    converge: converge.yml
    verify: verify.yml
  inventory:
    host_vars:
      instance:
        restic_enabled: true
        target_restic:
          enabled: true
          schedule: "0 2 * * *"
          retention:
            keep_last: 7
            keep_daily: 7
            keep_weekly: 4
            keep_monthly: 6
            keep_yearly: 1
          destinations:
            local:
              enabled: true
              path: /opt/backups/restic
            nas:
              enabled: false
        vault_restic_passwords:
          local: "test-password"
          nas: "test-password"
verifier:
  name: ansible
